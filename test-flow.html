<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test New Architecture Flow</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: white;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #444;
            border-radius: 8px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            background-color: #333;
            border-radius: 4px;
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            background-color: #2196F3;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #1976D2;
        }
    </style>
</head>
<body>
    <h1>New Architecture Test Flow</h1>
    
    <div class="test-section">
        <h2>1. Test CSV Upload Flow</h2>
        <button onclick="testCSVUpload()">Test CSV Upload</button>
        <div id="csv-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>2. Test Manual Input Flow</h2>
        <button onclick="testManualInput()">Test Manual Input</button>
        <div id="manual-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>3. Test Navigation</h2>
        <button onclick="window.location.href='http://localhost:3000'">Go to Landing Page</button>
        <button onclick="window.location.href='http://localhost:3000/analysis'">Go to Analysis Page</button>
        <button onclick="window.location.href='http://localhost:3000/results'">Go to Results Page</button>
    </div>

    <div class="test-section">
        <h2>4. SessionStorage Inspector</h2>
        <button onclick="inspectSessionStorage()">Inspect SessionStorage</button>
        <div id="storage-result" class="test-result"></div>
    </div>

    <script>
        function testCSVUpload() {
            // Simulate CSV content
            const csvContent = `Handle,Title,Option1 Value,Variant Price,Cost per item,Variant Requires Shipping,Vendor,Product Category,Variant SKU,Status
test-product-1,Test Product 1,Default Title,29.99,10.00,true,Test Vendor,Electronics,SKU001,active
test-product-2,Test Product 2,Large,49.99,20.00,true,Test Vendor,Electronics,SKU002,active`;
            
            sessionStorage.setItem('csvContent', csvContent);
            sessionStorage.setItem('fileName', 'test_products.csv');
            
            document.getElementById('csv-result').innerHTML = 
                '<span class="success">✓ CSV content stored in sessionStorage</span><br>' +
                'Now navigate to Analysis page to see if it loads correctly.';
        }

        function testManualInput() {
            sessionStorage.removeItem('csvContent');
            sessionStorage.removeItem('fileName');
            
            document.getElementById('manual-result').innerHTML = 
                '<span class="success">✓ SessionStorage cleared for manual input</span><br>' +
                'Now navigate to Analysis page for manual input mode.';
        }

        function inspectSessionStorage() {
            const result = document.getElementById('storage-result');
            result.innerHTML = '<h3>Current SessionStorage:</h3>';
            
            if (sessionStorage.length === 0) {
                result.innerHTML += '<span class="error">SessionStorage is empty</span>';
            } else {
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    const value = sessionStorage.getItem(key);
                    const preview = value.length > 100 ? value.substring(0, 100) + '...' : value;
                    result.innerHTML += `<div><strong>${key}:</strong> ${preview}</div>`;
                }
            }
        }

        // Auto-inspect on load
        window.onload = () => {
            inspectSessionStorage();
        };
    </script>
</body>
</html>